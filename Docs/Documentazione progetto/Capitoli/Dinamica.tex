\chapter{Scomposizione del VAB}
\section{Considerazioni iniziali}
Per il calcolo delle equazioni dinamiche del sistema siamo andati a considerare ogni singolo corpo rigido componente il sistema, calcolandone le grandezze fisiche di posizione e velocità, seguendo un approccio cartesiano. 
Nello specifico abbiamo considerato il sistema composto da:
\begin{itemize}
	\item Asta
	\item Utente a bordo dello chassis
	\item Chassis (nel corso della trattazione sarà chiamata talvolta anche base)
	\item Ruota (che poi sarà considerata con un contributo, essendo il VAB composto da due ruote)
\end{itemize}

Ognuno di questi corpi rigidi separati è individuato da un punto, che ne rappresenta il centro di massa (o baricentro del corpo stesso): avremo quindi questo insieme di punti caratterizzanti il sistema (figura ~\ref{fig:VAB_baricentri})

\begin{itemize}
	\item \textbf{$P_a$}
	\item \textbf{$P_b$}
	\item \textbf{$P_c$}
	\item \textbf{$P_r$}
\end{itemize}

\begin{figure}[h]
	\centering   	
	\includegraphics[width=0.4\textwidth]{Immagini/VAB_baricentrum.png}
	\caption{Baricentri dei singoli corpi rigidi}
	\label{fig:VAB_baricentri}
\end{figure} 

\section{Grandezze di supporto}
Prima di andare a definire le componenti di energia potenziale e cinetica di ogni singolo corpo, siamo andati ad introdurre alcune grandezze geometriche di supporto che definiremo qui di seguito.

Nello specifico abbiamo introdotto i seguenti parametri, specificati anche in figura ~\ref{fig:VAB_lunghezze}:
\begin{itemize}
	\item \textbf{$l_a$}: rappresenta la congiungente tra il centro del sistema di riferimento e il centro dell'asta, utilizzata appunto come manubrio, che abbiamo individuato come
	\begin{center}
		{\Large $\sqrt{(\frac{h_a}{2} + \frac{h_b}{2})^2 + (\frac{w_b}{2})^2}$}
	\end{center}
	\item \textbf{$l_c$}: (TODO: check) questa grandezza invece rappresenta per noi l'altezza del baricentro del corpo dell'utente, la quale ovviamente andrà a dipendere dal valore di inclinazione del corpo stesso.
	Considerando il corpo inzialmente in posizione verticale, avremo che questa grandezza corrisponde alla congiungente dal centro del sistema di riferimento al punto $P_c$, che equivale a dire che
	\begin{center}
		$l_c = 0.55\bullet h_c + \frac{h_b}{2}$
	\end{center}
	\item \textbf{$l_b$}: spostamento verso il basso, lungo l'asse z, del baricentro dello chassis. Da specifiche del progetto sappiamo che questa grandezza ha valore (con segno negativo) di:
	\begin{center}
		$l_b = 0.1 m$
	\end{center}
	\item \textbf{$\beta$}: angolo formato con la verticale dalla congiungente tra il centro del sistema di riferimento e il punto $P_a$. Si ricava, con un semplice approccio trigonometrico, che l'angolo in questione ha questa forma
	\begin{center}
		$\arctan{(\frac{\frac{w_b}{2}}{\frac{h_a}{2} + \frac{h_b}{2}})}$
	\end{center}
\end{itemize}

\begin{figure}[h]
	\centering   	
	\includegraphics[width=0.4\textwidth]{Immagini/VAB_additionalMeasures.png}
	\caption{Lunghezze di supporto}
	\label{fig:VAB_lunghezze}
\end{figure}

\section{Calcolo componenti dinamiche e potenziali per ogni corpo rigido del sistema}
Per ognuno dei corpi rigidi definiti in precedenza siamo andati appunto a calcolare:

\begin{itemize}
	\item \textbf{Coordinate spaziali P} espresse nel sistema di riferimento XZ. A queste due coordinate cartesiane ne va aggiunta una terza, relativa alle coordinate angolari (per poter tener così conto dei contirbuti inerziali);
	\item \textbf{Vettore delle velocità V} $\rightarrow$ vettore $3\times 1$
	\item \textbf{Matrice delle masse M} $\rightarrow$ matrice $3\times 3$
	\item \textbf{Energia cinetica T} $\rightarrow \frac{1}{2}\bullet V^T \bullet M \bullet V$
	\item \textbf{Energia potenziale U}
	\item \textbf{Lagrangiana \textit{parziale} L}
\end{itemize}

\subsection{Asta}
\begin{itemize}
	\item \textbf{$P_a = \left(\begin{array}{c}
		r\,\phi \left(t\right)+l_a \,\mathrm{sin}\left(\beta +\theta \left(t\right)\right)\\
		l_a \,\mathrm{cos}\left(\beta +\theta \left(t\right)\right)\\
		\theta \left(t\right)
		\end{array}\right)$}

	\item \textbf{$V_a = \left(\begin{array}{c}
		r\,\dot{\phi \left(t\right)}+l_a \,\mathrm{cos}\left(\beta +\theta \left(t\right)\right)\,\dot{\theta \left(t\right)}\\
		-l_a \,\mathrm{sin}\left(\beta +\theta \left(t\right)\right)\,\dot{\theta \left(t\right)}\\
		\dot{\theta \left(t\right)}
		\end{array}\right)$}
	
	\item \textbf{$M_a = \left(\begin{array}{ccc}
		m_a  & 0 & 0\\
		0 & m_a  & 0\\
		0 & 0 & m_a \,{l_a }^2 +J_a 
		\end{array}\right)$}
	
	\item \textbf{$T_a = m_a \,{l_a }^2 \,{{\left(\dot{\theta \left(t\right)}\right)}}^2 +\frac{m_a \,r^2 \,{{\left(\dot{\phi \left(t\right)}\right)}}^2 }{2}+\frac{J_a \,{{\left(\dot{\theta \left(t\right)}\right)}}^2 }{2}+m_a \,\mathrm{cos}\left(\beta +\theta \left(t\right)\right)\,l_a \,r\,\dot{\theta \left(t\right)}\,\dot{\phi \left(t\right)}$}
	
	\item \textbf{$U_a = g\,l_a \,m_a \,\mathrm{cos}\left(\beta +\theta \left(t\right)\right)$}
	
	\item \textbf{$L_a = m_a \,{l_a }^2 \,{{\left(\dot{\theta \left(t\right)}\right)}}^2 +\frac{m_a \,r^2 \,{{\left(\dot{\phi \left(t\right)}\right)}}^2 }{2}+\frac{J_a \,{{\left(\dot{\theta \left(t\right)}\right)}}^2 }{2}+m_a \,\mathrm{cos}\left(\beta +\theta \left(t\right)\right)\,l_a \,r\,\dot{\theta \left(t\right)}\,\dot{\phi \left(t\right)}-g\,m_a \,\mathrm{cos}\left(\beta +\theta \left(t\right)\right)\,l_a$}
\end{itemize}
\subsection{Chassis (base)}
\begin{itemize}
	\item \textbf{$P_b = \left(\begin{array}{c}
		r\,\phi \left(t\right)-l_b \,\mathrm{sin}\left(\theta \left(t\right)\right)\\
		-l_b \,\mathrm{cos}\left(\theta \left(t\right)\right)\\
		\theta \left(t\right)
		\end{array}\right)$}
	
	\item \textbf{$V_b = \left(\begin{array}{c}
		r\,\dot{\phi \left(t\right)}-l_b \,\mathrm{cos}\left(\theta \left(t\right)\right)\,\dot{\theta \left(t\right)}\\
		l_b \,\mathrm{sin}\left(\theta \left(t\right)\right)\,\dot{\theta \left(t\right)}\\
		\dot{\theta \left(t\right)}
		\end{array}\right)$}
	
	\item \textbf{$M_b = \left(\begin{array}{ccc}
		m_b  & 0 & 0\\
		0 & m_b  & 0\\
		0 & 0 & m_b \,{l_b }^2 +J_b 
		\end{array}\right)$}
	
	\item \textbf{$T_b = m_b \,{l_b }^2 \,{{\left(\dot{\theta \left(t\right)}\right)}}^2 +\frac{m_b \,r^2 \,{{\left(\dot{\phi \left(t\right)}\right)}}^2 }{2}+\frac{J_b \,{{\left(\dot{\theta \left(t\right)}\right)}}^2 }{2}-m_b \,\mathrm{cos}\left(\theta \left(t\right)\right)\,l_b \,r\,\dot{\theta \left(t\right)}\,\dot{\phi \left(t\right)}$}
	
	\item \textbf{$U_b = -g\,l_b \,m_b \,\mathrm{cos}\left(\theta \left(t\right)\right)$}
	
	\item \textbf{$L_b = m_b \,{l_b }^2 \,{{\left(\dot{\theta \left(t\right)}\right)}}^2 +\frac{m_b \,r^2 \,{{\left(\dot{\phi \left(t\right)}\right)}}^2 }{2}+\frac{J_b \,{{\left(\dot{\theta \left(t\right)}\right)}}^2 }{2}-m_b \,\mathrm{cos}\left(\theta \left(t\right)\right)\,l_b \,r\,\dot{\theta \left(t\right)}\,\dot{\phi \left(t\right)}+g\,m_b \,\mathrm{cos}\left(\theta \left(t\right)\right)\,l_b$}
\end{itemize}
\subsection{Utente}
\begin{itemize}
	\item \textbf{$P_c = \left(\begin{array}{c}
		r\,\phi \left(t\right)+l_c \,\mathrm{sin}\left(\alpha +\theta \left(t\right)\right)\\
		l_c \,\mathrm{cos}\left(\alpha +\theta \left(t\right)\right)\\
		\alpha +\theta \left(t\right)
		\end{array}\right)$}
	
	\item \textbf{$V_c = \left(\begin{array}{c}
		r\,\dot{\phi \left(t\right)}+l_c \,\mathrm{cos}\left(\alpha +\theta \left(t\right)\right)\,\dot{\theta \left(t\right)}\\
		-l_c \,\mathrm{sin}\left(\alpha +\theta \left(t\right)\right)\,\dot{\theta \left(t\right)}\\
		\dot{\theta \left(t\right)}
		\end{array}\right)$}
	
	\item \textbf{$M_c = \left(\begin{array}{ccc}
		m_c  & 0 & 0\\
		0 & m_c  & 0\\
		0 & 0 & m_c \,{l_c }^2 +J_c 
		\end{array}\right)$}
	
	\item \textbf{$T_c = m_c \,{l_c }^2 \,{{\left(\dot{\theta \left(t\right)}\right)}}^2 +\frac{m_c \,r^2 \,{{\left(\dot{\phi \left(t\right)}\right)}}^2 }{2}+\frac{J_c \,{{\left(\dot{\theta \left(t\right)}\right)}}^2 }{2}+m_c \,\mathrm{cos}\left(\alpha +\theta \left(t\right)\right)\,l_c \,r\,\dot{\theta \left(t\right)}\,\dot{\phi \left(t\right)}$}
	
	\item \textbf{$U_c = g\,l_c \,m_c \,\mathrm{cos}\left(\alpha +\theta \left(t\right)\right)$}
	
	\item \textbf{$L_c = m_c \,{l_c }^2 \,{{\left(\dot{\theta \left(t\right)}\right)}}^2 +\frac{m_c \,r^2 \,{{\left(\dot{\phi \left(t\right)}\right)}}^2 }{2}+\frac{J_c \,{{\left(\dot{\theta \left(t\right)}\right)}}^2 }{2}+m_c \,\mathrm{cos}\left(\alpha +\theta \left(t\right)\right)\,l_c \,r\,\dot{\theta \left(t\right)}\,\dot{\phi \left(t\right)}-g\,m_c \,\mathrm{cos}\left(\alpha +\theta \left(t\right)\right)\,l_c$}
\end{itemize}
\subsection{Ruota}
\begin{itemize}
	\item \textbf{$P_r = \left(\begin{array}{c}
		r\,\phi \left(t\right)\\
		0\\
		\phi \left(t\right)
		\end{array}\right)$}
	
	\item \textbf{$V_r = \left(\begin{array}{c}
		r\,\dot{\phi \left(t\right)}\\
		0\\
		\dot{\phi \left(t\right)}
		\end{array}\right)$}
	
	\item \textbf{$M_r = \left(\begin{array}{ccc}
		m_r  & 0 & 0\\
		0 & m_r  & 0\\
		0 & 0 & J_r 
		\end{array}\right)$} \label{matrix:mr}
	
	\item \textbf{$T_r = \frac{{\left(m_r \,r^2 +J_r \right)}\,{{\left(\dot{\phi \left(t\right)}\right)}}^2 }{2}$}
	
	\item \textbf{$U_r = 0$}
	
	\item \textbf{$L_r = \frac{{\left(m_r \,r^2 +J_r \right)}\,{{\left(\dot{\phi \left(t\right)}\right)}}^2 }{2}$}
\end{itemize}
\subsection{Note sul calcolo delle componenti dinamiche}
\begin{itemize}
	\item Nel calcolo della matrice di massa abbiamo considerato tre componenti:
	\begin{itemize}
		\item Componente di massa lungo x;
		\item Componente di massa lungo z;
		\item Componente di massa rotazionale: dalla meccanica è noto che, un corpo con una certa massa che si trova in uno stato di rotazione, avrà un contirbuto inerziale che dipende dal braccio rispetto al quale avviene la rotazione.
		Nello specifico, per ogni singolo corpo rigido che è stato preso in esame, abbiamo considerato, secondo il teorema di \textit{Huygens-Steiner}, il quale permette di definire l'inerzia di un corpo come la somma di due diverse componenti:
		\begin{itemize}
			\item Momento d'inerzia definito rispetto all'asse passante per il centro di massa: questo parametro rappresenta il valore che è fornito dalle specifiche del progetto;
			\item prodotto tra la massa \textit{m} del corpo preso in considerazione e la distanza tra l'asse in esame e quello passante per il centro di massa;
		\end{itemize}
		Questa terza componente è visibile nelle matrici di massa in posizione $(3, 1)$: si sottolinea come invece, per la matrice ~\ref{matrix:mr}, non sia presente la componente esplicitata dal teorema di \textit{Huygens-Steiner} per il fatto che il centro di massa della ruota coincide con quello del sistema di riferimento XZ;
 	\end{itemize}
 	\item Nel calcolo simbolico in ambiente \textit{Matlab} siamo andati ad utilizzare le funzionalità di \textit{collect} e \textit{simplify}, per permettere di ridurre e semplificare le equazioni. Nello specifico, con il comando simplify, tramite l'opzione \textit{Steps}, siamo andati a settare il numeor di step che l'algoritmo di calcolo simbolico andrà a seguire per poter ridurre e semplificare il maggior numero di termini ($\uparrow Steps, \uparrow $\textit{Compattezza eq symb});
 	
 	\item Le ruote, nel calcolo della dinamica completa del VAB, sono state considerate con un contirbuto doppio;
 	
 	\item Nello studio dello chassis (base), abbiamo seguito questo approccio. Il baricentro della base stessa sappiamo essere posizionato ad una quota differente rispetto al centro del sistem di coordinate XZ preso come riferimento.
 	
 	Per questo motivo il suo contributo in termini cinetici e potenziali dipende dal valore dell'inclinazione dello chassis stesso, ovvero dal valore dell'angolo \textit{caratterizzante} il sistema $\theta$: questo concetto è evidenziato in figura ~\ref{fig:chassis}.L'aggiunta di \textit{$\pi$} al valore di $\theta$ è necessaria per poter rendere sensibile i valori di energia cinetica e potenziale al \textit{quadrante} in cui si trova ad essere posizionato il centro di amssa della abse stessa ($P_b$).
 	
 	\begin{figure}[h]
 		\centering   	
 		\includegraphics[width=0.6\textwidth]{Immagini/ChassisAngle.jpg}
 		\caption{Ragionamento per il calcolo dei contributi dinamici dello chassis}
 		\label{fig:chassis}
 	\end{figure}
 	
\end{itemize}